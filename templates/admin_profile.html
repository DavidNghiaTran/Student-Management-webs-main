{% extends "_layout.html" %}

{% block title %}Thông tin cá nhân{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">Thông tin cá nhân</div>
    <div class="card-body">
        <div style="display: grid; grid-template-columns: 280px 1fr; gap: 2.5rem;">
            <!-- Left Column: Avatar & Read-only Info -->
            <div style="text-align: center;">
                <div class="avatar-circle lg"
                    style="margin: 0 auto 1.5rem auto; width: 140px; height: 140px; font-size: 3.5rem; background: var(--primary-light); color: var(--primary-color);">
                    {{ teacher.ho_ten[0] | upper }}
                </div>
                <h3 style="margin-bottom: 0.5rem; color: var(--primary-dark);">{{ teacher.ho_ten }}</h3>
                <p style="color: var(--muted-text); margin-bottom: 0.5rem; font-weight: 500;">
                    {% if is_admin %}
                    {{ teacher.chuc_vu or 'Quản trị viên' }}
                    {% else %}
                    {{ teacher.hoc_vi or 'Giáo viên' }}
                    {% endif %}
                </p>

                {% if teacher.khoa_bo_mon or teacher.phong_ban %}
                <div class="badge badge-info" style="margin-bottom: 1.5rem; display: inline-block;">
                    {% if is_admin %}
                    {{ teacher.phong_ban }}
                    {% else %}
                    {{ teacher.khoa_bo_mon }}
                    {% endif %}
                </div>
                {% endif %}

                <div
                    style="text-align: left; background: #f8fafc; padding: 1.25rem; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                    <div style="margin-bottom: 1rem;">
                        <small
                            style="display: block; color: var(--muted-text); font-weight: 600; text-transform: uppercase; font-size: 0.75rem; letter-spacing: 0.5px;">
                            {% if is_admin %}Mã Nhân viên{% else %}Mã Giáo viên{% endif %}
                        </small>
                        <div
                            style="font-weight: 600; font-family: monospace; font-size: 1.1rem; color: var(--text-color);">
                            {% if is_admin %}{{ teacher.ma_nv }}{% else %}{{ teacher.ma_gv }}{% endif %}
                        </div>
                    </div>
                    {% if teacher.van_phong %}
                    <div>
                        <small
                            style="display: block; color: var(--muted-text); font-weight: 600; text-transform: uppercase; font-size: 0.75rem; letter-spacing: 0.5px;">Văn
                            phòng</small>
                        <div style="font-weight: 500; color: var(--text-color);">
                            <i class="fa-solid fa-building" style="color: var(--muted-text); margin-right: 5px;"></i>
                            {{ teacher.van_phong }}
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Right Column: Edit Form -->
            <div>
                <form method="post" class="form-grid two">
                    <div style="grid-column: 1/-1;">
                        <h4
                            style="margin-bottom: 1.5rem; border-bottom: 2px solid #f1f5f9; padding-bottom: 0.75rem; color: var(--primary-dark); display: flex; align-items: center; gap: 10px;">
                            <i class="fa-solid fa-user-pen" style="color: var(--primary-color);"></i>
                            Thông tin chung
                        </h4>
                    </div>

                    <div style="grid-column: 1/-1;">
                        <label>Họ và tên <span style="color: red;">*</span></label>
                        <input type="text" name="ho_ten" value="{{ teacher.ho_ten }}" required class="form-control">
                    </div>

                    <div>
                        <label>Email</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fa-solid fa-envelope"></i></span>
                            <input type="email" name="email" value="{{ teacher.email or '' }}" class="form-control">
                        </div>
                    </div>

                    <div>
                        <label>Số điện thoại</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="fa-solid fa-phone"></i></span>
                            <input type="text" name="so_dien_thoai" value="{{ teacher.so_dien_thoai or '' }}"
                                class="form-control">
                        </div>
                    </div>

                    {% if is_admin %}
                    <!-- Admin Specific Fields -->
                    <div>
                        <label>Phòng ban</label>
                        <input type="text" name="phong_ban" value="{{ teacher.phong_ban or '' }}" class="form-control">
                    </div>

                    <div>
                        <label>Chức vụ</label>
                        <input type="text" name="chuc_vu" value="{{ teacher.chuc_vu or '' }}" class="form-control">
                    </div>
                    {% else %}
                    <!-- Teacher Specific Fields -->
                    <div>
                        <label>Khoa / Bộ môn</label>
                        <input type="text" name="khoa_bo_mon" value="{{ teacher.khoa_bo_mon or '' }}"
                            class="form-control">
                    </div>

                    <div>
                        <label>Học vị</label>
                        <select name="hoc_vi" class="form-control">
                            <option value="">-- Chọn --</option>
                            <option value="Cử nhân" {% if teacher.hoc_vi=='Cử nhân' %}selected{% endif %}>Cử nhân
                            </option>
                            <option value="Thạc sĩ" {% if teacher.hoc_vi=='Thạc sĩ' %}selected{% endif %}>Thạc sĩ
                            </option>
                            <option value="Tiến sĩ" {% if teacher.hoc_vi=='Tiến sĩ' %}selected{% endif %}>Tiến sĩ
                            </option>
                            <option value="Phó Giáo sư" {% if teacher.hoc_vi=='Phó Giáo sư' %}selected{% endif %}>Phó
                                Giáo sư</option>
                            <option value="Giáo sư" {% if teacher.hoc_vi=='Giáo sư' %}selected{% endif %}>Giáo sư
                            </option>
                        </select>
                    </div>

                    <div style="grid-column: 1/-1;">
                        <label>Văn phòng làm việc</label>
                        <input type="text" name="van_phong" value="{{ teacher.van_phong or '' }}"
                            placeholder="VD: P.301 - Nhà A2" class="form-control">
                    </div>

                    <div style="grid-column: 1/-1;">
                        <label>Lĩnh vực nghiên cứu / Giảng dạy</label>
                        <textarea name="linh_vuc" rows="3" class="form-control">{{ teacher.linh_vuc or '' }}</textarea>
                    </div>
                    {% endif %}

                    <div style="grid-column: 1/-1; margin-top: 1.5rem;">
                        <h4
                            style="margin-bottom: 1.5rem; border-bottom: 2px solid #f1f5f9; padding-bottom: 0.75rem; color: var(--danger-color); display: flex; align-items: center; gap: 10px;">
                            <i class="fa-solid fa-shield-halved"></i>
                            Bảo mật & Mật khẩu
                        </h4>
                        <div class="alert info" style="font-size: 0.9rem; margin-bottom: 1.5rem;">
                            <i class="fa-solid fa-circle-info"></i> Để trống các trường bên dưới nếu bạn không muốn thay
                            đổi mật khẩu.
                        </div>
                    </div>

                    <div>
                        <label>Mật khẩu mới</label>
                        <input type="password" name="new_password" placeholder="Nhập mật khẩu mới..."
                            class="form-control">
                    </div>
                    <div>
                        <label>Xác nhận mật khẩu</label>
                        <input type="password" name="confirm_password" placeholder="Nhập lại mật khẩu mới..."
                            class="form-control">
                    </div>

                    <div class="form-actions"
                        style="grid-column: 1/-1; justify-content: flex-end; margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color);">
                        <button type="submit" class="btn btn-primary" style="padding: 0.75rem 2rem; font-size: 1rem;">
                            <i class="fa-solid fa-floppy-disk"></i> Lưu thay đổi
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}